<div class="container" 
		ng-controller="customStatusCtrl"
		filtered-list="{method: 'tasks/dictionary/getCustomStatuses'}"
		initial-sorters="{ ViewOrder: 'asc' }">
	<div class="row" id="content-wrapper">

		<!-- Filter -->
		<div class="col-xs-12">
			<filter meta="tasks/dictionary/customStatusMetadata" group="Tasks.CustomStatus">
				<form class="form">
					<div class="form-group">
						<label>{{ i18n.core.fields.name }}</label>
						<input type="text" ng-model="filter.simple.Name" filter-node="{path: 'Name', op:'like'}"  class="form-control" />
					</div>
				</form>
			</filter>
		</div><!-- filter -->

		<!-- Content -->
		<div class="col-xs-12">
			<div class="box box-nomargin">
				<div class="box-header purple-background">
					<div class="title">{{ i18n.tasks.customStatuses.title }}</div>
					<div class="actions">
						<a class="btn box-collapse btn-xs btn-link" href="#"><i></i></a>
					</div>
				</div>
				<div class="box-content">
					<div class="box-toolbox box-toolbox-top">
						<ago-error-msg></ago-error-msg>

						<form name="createStatusForm" class="form-inline" novalidate>
							<div class="col-sm-6" ng-class="{'has-error': (createStatusForm.$invalid || validation.fieldErrors['Name'] || validation.fieldErrors['ViewOrder'])}">
								<!-- input -->
								<div class="row">
									<div class="col-md-6" style="padding-left: 0px">
										<input type="text" name="name" ng-model="editModel.name" class="form-control" placeholder="{{ i18n.tasks.customStatuses.placeholders.name }}" ng-required="editModel.focused" ng-focus="editModel.focused=true" ng-blur="editModel.focused=false" />
									</div>
									<div class="col-md-2" style="padding-left: 0px">
										<input type="text" name="viewOrder" ago-integer ago-min="0" ago-max="255" ng-model="editModel.viewOrder" class="form-control" placeholder="{{ i18n.core.fields.viewOrder }}" ng-required="editModel.focused" ng-focus="editModel.focused=true" ng-blur="editModel.focused=false" />
									</div>
									<div class="col-md-4 btn-group" style="padding-left: 0px">
										<button type="button" class="btn" ng-click="createStatus()" ng-disabled="!createEnabled()">{{ i18n.core.buttons.add }}</button>
										<button type="button" class="btn" ng-click="dropChanges()" title="{{ i18n.core.buttons.clear }}">&times;</button>
									</div>
								</div>
								<!-- validation -->
								<div class="row">
									<div class="col-md-12">
										<span ng-show="validation.fieldErrors['Name']" class="help-block has-error">
											{{ validation.fieldErrors['Name'] | joinBy }}
										</span>
										<span ng-show="isViewOrderInvalid()" class="help-block has-error">
											{{ 'core.errors.integerInRange' | i18n:{ range: '[0-255]' } }}
										</span>
										<span ng-show="validation.fieldErrors['ViewOrder']" class="help-block has-error">
											{{ validation.fieldErrors['ViewOrder'] | joinBy }}
										</span>
									</div>
								</div>
							</div>

							<div class="col-sm-6">
								<div class="row">
									<div class="col-md-3">
										<button type="button" class="btn pull-right" ng-click="deleteSelected()" ng-disabled="!hasSelected()">{{ i18n.core.buttons.delete }}</button>
									</div>
									<div class="col-md-9" style="padding-left: 0px">
										<input type="text" lookup="tasks/dictionary/lookupCustomStatuses" lookup-options="{allowClear: true}" ng-model="deleteModel.replacementStatus" placeholder="{{ i18n.tasks.customStatuses.placeholders.replacementStatus }}" class="form-control"></input>
									</div>
								</div>
							</div>
						</form>
					</div><!-- toolbox -->

					<div class="responsive-table">
						<div class="scrollable-area">

							<table class="table table-bordered"
							       infinite-scroll="paging.page = paging.page + 1"
							       infinite-scroll-disabled="applyEnabled"
							       infinite-scroll-distance="1">
								<thead>
								<tr>
									<th style="width: 1%">
										<input type="checkbox" checker="items: 'models'">
									</th>
									<th><span sortable-heading="sorters.Name" caption="{{ i18n.core.fields.name }}"></span></th>
									<th style="width: 15%"><span sortable-heading="sorters.ViewOrder" caption="{{ i18n.core.fields.viewOrder }}"></span></th>
									<th style="width: 15%"><span sortable-heading="sorters.Creator_FIO" caption="{{ i18n.core.fields.creator }}"></span></th>
									<th style="width: 20%"><span sortable-heading="sorters.CreationTime" caption="{{ i18n.core.fields.creationTime }}"></span></th>
									<th style="width: 1%">&nbsp;</th>
								</tr>
								</thead>
								<tbody>
								<tr ng-repeat="model in models">
									<td>
										<input type="checkbox" ng-model="model.selected" data-itemid="{{ model.Id }}">
									</td>
									<td>
										<inline-text model="model.Name" on-update="onUpdateProp(model, 'Name', val)" on-cancel="onCancel(model, val)" input-col="col-xs-12" required></inline-text>
										<span ng-show="model.validation.fieldErrors['Name']" class="help-block has-error">
											{{ model.validation.fieldErrors['Name'] | joinBy }}
										</span>
									</td>
									<td>
										<inline-text model="model.ViewOrder" on-update="onUpdateProp(model, 'ViewOrder', val)" on-cancel="onCancel(model, val)" input-col="col-xs-12" required></inline-text>
										<span ng-show="model.validation.fieldErrors['ViewOrder']" class="help-block alert-error">
											{{ model.validation.fieldErrors['ViewOrder'] | joinBy }}
										</span>
									</td>
									<td>{{ model.Author }}</td>
									<td>{{ model.CreationTime | date:'dd.MM.yyyy hh:mm:ss' }}</td>
									<td>
										<button type="button" class="close" title="{{ i18n.tasks.customStatuses.buttons.delete }}" ng-click="delete(model)">&times;</button>
									</td>
								</tr>
								</tbody>
							</table>

							<div ng-show="indication.loading" us-spinner="{top:100}"></div>
						</div><!-- scrollable-area -->
					</div><!-- responsive-table -->

					<div class="box-toolbox box-toolbox-bottom">
						<button type="button" class="btn btn-primary" ng-click="paging.page = paging.page + 1" ng-disabled="applyEnabled">{{ i18n.core.buttons.more }}</button>
			    	</div><!-- toolbox bottom -->
				</div><!-- box-content -->
			</div><!-- box -->
		</div><!-- col-xs-12 content -->
	</div><!-- row -->
</div><!-- container -->