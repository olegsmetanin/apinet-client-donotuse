<div class="container-fluid" ng-controller="taskViewCtrl">
	<div class="row-fluid">
		<div class="span12">
			<task-tabs current-tab="overview" task-num="model.SeqNumber"></task-tabs>
		</div>
	</div>
	<div class="row-fluid">
		<div class="span3">
			<div class="well">
				<ul class="nav nav-list">
					<li>
						<a href="#general">
							{{ 'tasks.view.general.title' | i18n }}
						</a>
					</li>
					<li>
						<a href="#agreements">
							{{ 'tasks.view.agreements.title' | i18n }}
						</a>
					</li>
					<li>
						<a href="#statusHistory">
							{{ 'tasks.view.statusHistory.title' | i18n }}
						</a>
					</li>
					<li>
						<a href="#customStatusHistory">
							{{ 'tasks.view.customStatusHistory.title' | i18n }}
						</a>
					</li>
					<li>
						<a href="#params">
							{{ 'tasks.view.params.title' | i18n }}
						</a>
					</li>
				</ul>
			</div>
		</div>
		<div class="span9">
			<div class="alert alert-error span12" ng-show="validation.generalErrors">
				{{ validation.generalErrors | joinBy }}
			</div>

			<section id="general">
				<h3>{{ 'tasks.view.general.title' | i18n }}</h3>
				<table class="table">
					<tr>
						<td class="span3">{{ 'tasks.fields.seqNumber' | i18n }}</td>
						<td>{{ model.SeqNumber }}</td>
					</tr>
					<tr>
						<td>{{ 'tasks.fields.type' | i18n }}</td>
						<td>
							<inline-lookup model="model.TaskType" on-update="onUpdateProp(model, 'TaskType', val)" on-cancel="resetValidation()"
							               input-lookup="tasks/dictionary/lookupTaskTypes" input-class="span6" required></inline-lookup>
							<span ng-show="validation.fieldErrors['TaskType']" class="help-block alert-error">
								{{ validation.fieldErrors['TaskType'] | joinBy }}
							</span>
						</td>
					</tr>
					<tr>
						<td>{{ 'tasks.fields.executors' | i18n }}</td>
						<td>
							<inline-lookup model="model.Executors" on-update="onUpdateProp(model, 'Executors', val)" on-cancel="resetValidation()"
							               input-lookup="home/projects/lookupParticipant" input-class="span10" multiple required>
								<executors model="model.Executors"></executors>
							</inline-lookup>
							<span ng-show="validation.fieldErrors['Executors']" class="help-block alert-error">
								{{ validation.fieldErrors['Executors'] | joinBy }}
							</span>
						</td>
					</tr>
					<tr>
						<td>{{ 'tasks.fields.content' | i18n }}</td>
						<td>
							<inline-text-area model="model.Content" on-update="onUpdateProp(model, 'Content', val)" on-cancel="resetValidation()"
							                  pre-class="span10" input-class="span10" input-rows="3"></inline-text-area>
							<span ng-show="validation.fieldErrors['Content']" class="help-block alert-error">
								{{ validation.fieldErrors['Content'] | joinBy }}
							</span>
						</td>
					</tr>
					<tr>
						<td>{{ 'tasks.fields.dueDate' | i18n }}</td>
						<td>
							<inline-date model="model.DueDate" on-update="onUpdateProp(model, 'DueDate', val)" on-cancel="resetValidation()" date-format="dd.MM.yyyy"></inline-date>
							<span ng-show="validation.fieldErrors['DueDate']" class="help-block alert-error">
								{{ validation.fieldErrors['DueDate'] | joinBy }}
							</span>
						</td>
					</tr>
					<tr>
						<td>{{ 'tasks.fields.status' | i18n }}</td>
						<td>
							<inline-lookup model="model.Status" on-update="onUpdateProp(model, 'Status', val)" on-cancel="resetValidation()"
							               input-lookup="tasks/dictionary/lookupTaskStatuses" input-class="span6" required></inline-lookup>
							<span ng-show="validation.fieldErrors['Status']" class="help-block alert-error">
								{{ validation.fieldErrors['Status'] | joinBy }}
							</span>
						</td>
					</tr>
					<tr>
						<td>{{ 'tasks.fields.customStatus' | i18n }}</td>
						<td>
							<inline-lookup model="model.CustomStatus" on-update="onUpdateProp(model, 'CustomStatus', val)" on-cancel="resetValidation()"
							               input-lookup="tasks/dictionary/lookupCustomStatuses" input-class="span6"></inline-lookup>
							<span ng-show="validation.fieldErrors['CustomStatus']" class="help-block alert-error">
								{{ validation.fieldErrors['CustomStatus'] | joinBy }}
							</span>
						</td>
					</tr>
					<tr>
						<td>{{ 'tasks.fields.priority' | i18n }}</td>
						<td>
							<inline-lookup model="model.Priority" on-update="onUpdateProp(model, 'Priority', val)" on-cancel="resetValidation()"
							               input-lookup="tasks/dictionary/lookupTaskPriorities" input-class="span6" required></inline-lookup>
							<span ng-show="validation.fieldErrors['Priority']" class="help-block alert-error">
								{{ validation.fieldErrors['Priority'] | joinBy }}
							</span>
						</td>
					</tr>
					<tr>
						<td>{{ 'core.fields.creator' | i18n }}</td>
						<td>{{ model.Author }}</td>
					</tr>
					<tr>
						<td>{{ 'core.fields.creationTime' | i18n }}</td>
						<td>{{ model.CreationTime | date:'dd.MM.yyyy hh:mm:ss' }}</td>
					</tr>
				</table>
			</section>
			<section id="agreements">
				<h3>{{ 'tasks.view.agreements.title' | i18n }}</h3>
				<agreements model="model"></agreements>
			</section>
			<section id="statusHistory">
				<h3>{{ 'tasks.view.statusHistory.title' | i18n }}</h3>
				<status-history model="model.StatusHistory" change="changeStatus"></status-history>
			</section>
			<section id="customStatusHistory">
				<h3>{{ 'tasks.view.customStatusHistory.title' | i18n }}</h3>
				<status-history model="model.CustomStatusHistory" change="changeCustomStatus"></status-history>
			</section>
			<section id="params">
				<h3>{{ 'tasks.view.params.title' | i18n }}</h3>
				<custom-properties model="model.Parameters"></custom-properties>
			</section>
		</div>
	</div>
</div>